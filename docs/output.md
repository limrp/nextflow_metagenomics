# limrp/metagenomics: Output

## Introduction

This document describes the output produced by the pipeline. Most of the plots are taken from the MultiQC report, which summarises results at the end of the pipeline.

The directories listed below will be created in the results directory after the pipeline has finished. All paths are relative to the top-level results directory.

<!-- TODO nf-core: Write this documentation describing your workflow's output -->

## Pipeline overview

The pipeline is built using [Nextflow](https://www.nextflow.io/) and processes data using the following steps:

- [Prodigal](#fastqc) - Prodigal provides fast, accurate gene predictions in GFF3 or Genbank.
- [CD-HIT](#CD-HIT) - a very widely used program for clustering and comparing protein or nucleotide sequences.
- [Kraken2](#Kraken2) - a taxonomic classification tool that uses exact k-mer matches to find the lowest common ancestor (LCA) of a given sequence.
- [Kaiju](#Kaiju) - Fast and sensitive taxonomic classification for metagenomics.
- [MultiQC](#multiqc) - Aggregate report describing results and QC from the whole pipeline
- [Pipeline information](#pipeline-information) - Report metrics generated during the workflow execution

### Prodigal

<details markdown="1">
<summary>Output files</summary>

- `annotation_prodigal/`
  - `*.fna.gz`: Gene predictions in fasta format.

</details>

[Prodigal](https://github.com/hyattpd/Prodigal) (Prokaryotic Dynamic Programming Genefinding Algorithm) will serve as the first step in the pipeline, being used for the identification of genes within microbial DNA sequences. Its accuracy in predicting the genetic elements of microbial communities forms a robust foundation for the subsequent analysis stages. For further reading and documentation see the [Prodigal Wiki Documentation](https://github.com/hyattpd/prodigal/wiki).

> **NB:** The FastQC plots displayed in the MultiQC report shows _untrimmed_ reads. They may contain adapter sequence and potentially regions with low quality.

### CD-HIT

<details markdown="1">
<summary>Output files</summary>

- `cdhit/`
  - `*.fasta`: Clustered nucleotide sequences of gene predictions.

</details>

[CD-HIT](https://sites.google.com/view/cd-hit) Following gene identification, CD-HIT comes into play to assist in clustering similar nucleotide sequences, facilitating the reduction of data redundancy and complexity. This step is crucial for enhancing the efficiency and speed of the later analytical stages. For further reading and documentation see the [CD-HIT Wiki Documentation](https://github.com/weizhongli/cdhit/wiki).

### Kraken2

<details markdown="1">
<summary>Output files</summary>

- `kraken/`
  - `*.report`: Taxonomic classification of nucleotide sequences, categorizing them into distinct taxa.

</details>

[Kraken](https://ccb.jhu.edu/software/kraken2/) A rapid sequence classification tool will then be applied to align the sequences against a comprehensive database. It enables the high-throughput assignment of taxonomic labels to the sequences, offering insights into the microbial communities present in the sample. For further reading and documentation see the [Kraken2 Wiki Documentation](https://github.com/DerrickWood/kraken2/wiki).

### Kaiju

<details markdown="1">
<summary>Output files</summary>

- `kraken/`
  - `*.report`: Taxonomic assignments based on the classification of nucleotide sequences by comparing them to a database of protein sequences.

</details>

[Kraken](https://ccb.jhu.edu/software/kraken2/) A rapid sequence classification tool will then be applied to align the sequences against a comprehensive database. It enables the high-throughput assignment of taxonomic labels to the sequences, offering insights into the microbial communities present in the sample. For further reading and documentation see the [Kraken2 Wiki Documentation](https://github.com/DerrickWood/kraken2/wiki).

### MultiQC

<details markdown="1">
<summary>Output files</summary>

- `multiqc/`
  - `multiqc_report.html`: a standalone HTML file that can be viewed in your web browser.
  - `multiqc_data/`: directory containing parsed statistics from the different tools used in the pipeline.
  - `multiqc_plots/`: directory containing static images from the report in various formats.

</details>

[MultiQC](http://multiqc.info) is a visualization tool that generates a single HTML report summarising all samples in your project. Most of the pipeline QC results are visualised in the report and further statistics are available in the report data directory.

Results generated by MultiQC collate pipeline QC from supported tools e.g. FastQC. The pipeline has special steps which also allow the software versions to be reported in the MultiQC output for future traceability. For more information about how to use MultiQC reports, see <http://multiqc.info>.

### Pipeline information

<details markdown="1">
<summary>Output files</summary>

- `pipeline_info/`
  - Reports generated by Nextflow: `execution_report.html`, `execution_timeline.html`, `execution_trace.txt` and `pipeline_dag.dot`/`pipeline_dag.svg`.
  - Reports generated by the pipeline: `pipeline_report.html`, `pipeline_report.txt` and `software_versions.yml`. The `pipeline_report*` files will only be present if the `--email` / `--email_on_fail` parameter's are used when running the pipeline.
  - Reformatted samplesheet files used as input to the pipeline: `samplesheet.valid.csv`.

</details>

[Nextflow](https://www.nextflow.io/docs/latest/tracing.html) provides excellent functionality for generating various reports relevant to the running and execution of the pipeline. This will allow you to troubleshoot errors with the running of the pipeline, and also provide you with other information such as launch commands, run times and resource usage.
